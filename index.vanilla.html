<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>3D Building Demo</title>
    <style>
        body { margin: 0; overflow: hidden; background: #111; }
        canvas { display: block; }
    </style>
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<script>
// --------------------------------------------------
// Scene, Camera, Renderer
// --------------------------------------------------
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(10, 15, 20);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Orbit controls (rotate cube, zoom, pan)
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.target.set(0, 3, 0);

// --------------------------------------------------
// Create Building Group (so whole cube rotates)
// --------------------------------------------------
const building = new THREE.Group();
scene.add(building);

// --------------------------------------------------
// Floors
// --------------------------------------------------
const floorCount = 3;
const floorSize = 10;
const floorHeight = 4;

const floors = [];
const firefighters = [];

const floorMaterial = new THREE.MeshBasicMaterial({
    color: 0x303030,
    wireframe: true
});

for (let i = 0; i < floorCount; i++) {
    // Floor plane
    const geo = new THREE.PlaneGeometry(floorSize, floorSize);
    const floor = new THREE.Mesh(geo, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    floor.position.y = i * floorHeight;
    building.add(floor);
    floors.push(floor);

    // Firefighters (moving dots)
    const ffGroup = new THREE.Group();
    building.add(ffGroup);
    firefighters.push(ffGroup);

    for (let j = 0; j < 8; j++) {
        const dot = new THREE.Mesh(
            new THREE.SphereGeometry(0.2, 16, 16),
            new THREE.MeshBasicMaterial({ color: 0xff3300 })
        );
        dot.position.set(
            (Math.random() - 0.5) * floorSize,
            i * floorHeight + 0.1,
            (Math.random() - 0.5) * floorSize
        );
        dot.userData.vel = new THREE.Vector3(
            (Math.random()-0.5)*0.03,
            0,
            (Math.random()-0.5)*0.03
        );
        ffGroup.add(dot);
    }
}

// --------------------------------------------------
// Animation
// --------------------------------------------------
function animate() {
    requestAnimationFrame(animate);

    // Move firefighters
    firefighters.forEach((group, idx) => {
        group.children.forEach(dot => {
            dot.position.add(dot.userData.vel);

            // Bounce off edges
            if (Math.abs(dot.position.x) > floorSize/2) dot.userData.vel.x *= -1;
            if (Math.abs(dot.position.z) > floorSize/2) dot.userData.vel.z *= -1;
        });
    });

    controls.update();
    renderer.render(scene, camera);
}

animate();

// Resize
window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
